#!/bin/bash

TEST_NAME="CIS-3.2.1"
TEST_SUMMARY="Ensure source routed packets are not accepted"
TEST_SEVERITY="High"

#--------
# test scripting
#--------

TEST="`sysctl net.ipv4.conf.all.accept_source_route |tr -d ' '`"
if [ "$TEST" = "net.ipv4.conf.all.accept_source_route=0" ]
then
    :
else
    logit2 severity=$TEST_SEVERITY name="$TEST_NAME" summary="$TEST_SUMMARY"
fi

TEST="`sysctl net.ipv4.conf.default.accept_source_route |tr -d ' '`"
if [ "$TEST" = "net.ipv4.conf.default.accept_source_route=0" ]
then
    :
else
    logit2 severity=$TEST_SEVERITY name="$TEST_NAME" summary="$TEST_SUMMARY"
fi

